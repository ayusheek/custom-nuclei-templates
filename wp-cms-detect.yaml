id: wp-cms-detect

info:
  name: WordPress Detect
  author: dat-ayush
  severity: info
  description: Detects if a domain is running WordPress
  tags: cms,wordpress

flow: http(1) || http(2) || http(3)

http:
  - method: GET
    path:
      - "{{RootURL}}"

    redirects: true
    max-redirects: 3

    matchers:
      - type: regex
        regex:
          - "(?i)wordpress"

  - method: GET
    path:
      - "{{RootURL}}/wp-admin"
    
    redirects: true
    max-redirects: 3

    matchers:
      - type: word
        words:
          - 'Powered by WordPress'
    
  - method: GET
    path:
      - "{{RootURL}}/feed/"

    matchers:
      - type: regex
        regex:
          - '<generator>https?:\/\/wordpress\.org.*</generator>'
