id: branchio-subdomain-takeover

info:
  name: Branch.io Subdomain Takeover
  author: dat-ayush
  severity: high
  description: |
    Detects potential subdomain takeover vulnerability on Branch.io CNAMEs pointing to custom.bnc.lt.

dns:
  - name: check-branchio-takeover
    type: CNAME
    class: inet
    host: "{{FQDN}}"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "custom.bnc.lt"
      - type: dsl
        dsl:
          - "contains(dns_answer, 'custom.bnc.lt')"
